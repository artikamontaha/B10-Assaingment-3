;/*FB_PKG_DELIM*/

__d("MWChatEBPinCodeVerifyIndicator.react",["fbt","MWXRow.react","MWXRowItem.react","MWXSpinner.react","MWXText.react","react"],(function(a,b,c,d,e,f,g,h){"use strict";var i,j=i||d("react");function a(a){a=a.isMessenger;return j.jsxs(c("MWXRow.react"),{align:"center",paddingTop:8,spacing:8,children:[j.jsx(c("MWXRowItem.react"),{verticalAlign:"center",children:j.jsx(c("MWXSpinner.react"),{color:a?"disabled":"blue",size:12})}),j.jsx(c("MWXRowItem.react"),{verticalAlign:"center",children:j.jsx(c("MWXText.react"),{color:"secondary",testid:void 0,type:"meta3",children:h._("__JHASH__sqvt0agiqDI__JHASH__")})})]})}a.displayName=a.name+" [from "+f.id+"]";g["default"]=a}),226);
__d("MWChatEncrypedBackupsNumericCodeValidation",[],(function(a,b,c,d,e,f){"use strict";var g=function(a){var b=/^[0-9]*$/;return b.test(a)};a=function(a,b){return a.length>b?!1:g(a)};b=function(a,b){return a.length!==b?!1:g(a)};f.numericCodeIsValid=a;f.numericCodeIsCompleted=b}),66);
__d("MWChatEncryptedBackupsForgotPINDialogQuery_facebookRelayOperation",[],(function(a,b,c,d,e,f){e.exports="6355637124548827"}),null);
__d("MWChatEncryptedBackupsForgotPINDialogQuery$Parameters",["MWChatEncryptedBackupsForgotPINDialogQuery_facebookRelayOperation"],(function(a,b,c,d,e,f){"use strict";a={kind:"PreloadableConcreteRequest",params:{id:b("MWChatEncryptedBackupsForgotPINDialogQuery_facebookRelayOperation"),metadata:{},name:"MWChatEncryptedBackupsForgotPINDialogQuery",operationKind:"query",text:null}};e.exports=a}),null);
__d("MWChatEncryptedBackupsForgotPINDialog.entrypoint",["JSResourceForInteraction","MWChatEncryptedBackupsForgotPINDialogQuery$Parameters"],(function(a,b,c,d,e,f,g){"use strict";a={getPreloadProps:function(){return{queries:{queryReference:{parameters:c("MWChatEncryptedBackupsForgotPINDialogQuery$Parameters"),variables:{}}}}},root:c("JSResourceForInteraction")("MWChatEncryptedBackupsForgotPINDialog.react").__setRef("MWChatEncryptedBackupsForgotPINDialog.entrypoint")};g["default"]=a}),98);
__d("MWChatEncryptedBackupsNumericCodeErrorWrapper.react",["MWXColumn.react","MWXColumnItem.react","MWXText.react","react","stylex"],(function(a,b,c,d,e,f,g){"use strict";var h,i,j=i||d("react"),k={inputWrapperErrorOnly:{paddingBottom:"x18d9i69",$$css:!0},outterWrapper:{minHeight:"x10sr9ya",$$css:!0},outterWrapperSmall:{minHeight:"x1h7t28c",$$css:!0}};function a(a){var b=a.children,d=a.error;a=a.inputSize;a=a===void 0?"large":a;var e=a==="large"?k.outterWrapper:k.outterWrapperSmall;return j.jsx(c("MWXColumn.react"),{xstyle:e,children:j.jsxs(c("MWXColumnItem.react"),{align:"center",paddingHorizontal:a==="large"?20:0,paddingTop:0,children:[j.jsx("div",{className:(h||(h=c("stylex")))(d!=null&&[k.inputWrapperErrorOnly]),children:b}),d!=null?j.jsx("div",{className:"x1o1nzlu x1y1aw1k x2b8uid",children:j.jsx(c("MWXText.react"),{color:"negative",testid:void 0,type:"body4",children:d})}):null]})})}a.displayName=a.name+" [from "+f.id+"]";g["default"]=a}),98);
__d("MWChatEncryptedBackupsNumericCodeInputInner.react",["BaseTextInput.react","FocusRegion.react","MWChatEncrypedBackupsNumericCodeValidation","focusScopeQueries","gkx","react"],(function(a,b,c,d,e,f,g){"use strict";var h,i=h||(h=d("react"));b=h;var j=b.useCallback,k=b.useEffect,l=b.useRef,m=b.useState,n=c("gkx")("24058"),o={input:{height:"x5yr21d",start:"x17qophe",left:null,right:null,opacity:"xg01cxk",position:"x10l6tqk",top:"x13vifvy",width:"xh8yej3",$$css:!0},testOpacity:{opacity:"x1ptxcow",$$css:!0}};function a(a){var b=a.extraProps.setFocus;a=a.props;var e=a["aria-label"],f=a.disabled,g=f===void 0?!1:f;a.enableMasking;var h=a.focusRegionId;f=a.inputMode;var p=a.onChange,q=a.onCompletionChange,r=a.size,s=a.testid;a=a.value;var t=m(a.length===r),u=t[0],v=t[1],w=l(null),x=l(g);t="mw-numeric-code-input-prevent-composer-focus-steal";var y=j(function(a){var b=d("MWChatEncrypedBackupsNumericCodeValidation").numericCodeIsCompleted(a,r);p(a);q!=null&&b!==u&&(v(b),q(b))},[u,p,q,r]);k(function(){var a=function(a){a.preventDefault()},b=w.current;b==null?void 0:b.addEventListener("selectstart",a);return function(){b==null?void 0:b.removeEventListener("selectstart",a)}},[]);k(function(){g&&b(!1)},[g,b]);k(function(){x.current!==g&&(x.current=g,g||d("FocusRegion.react").focusRegionById(h,d("focusScopeQueries").tabbableScopeQuery))},[g,h]);return i.jsx(c("BaseTextInput.react"),{"aria-label":e,autoComplete:"one-time-code",disabled:g,id:s!=null?s+"-"+t:t,inputMode:f,maxLength:r,onBlur:function(){b(!1)},onFocus:function(){b(!0)},onKeyDown:function(a){var b=a.keyCode;(b===37||b===38||b===39||b===40)&&(a.preventDefault(),a.stopPropagation())},onValueChange:function(a){a=a.toString();d("MWChatEncrypedBackupsNumericCodeValidation").numericCodeIsValid(a,r)&&y(a)},ref:w,testid:void 0,value:a,xstyle:[o.input,n&&o.testOpacity]})}a.displayName=a.name+" [from "+f.id+"]";g["default"]=a}),98);
__d("MWChatEncryptedBackupsNumericCodeInputRenderer.react",["CometRow.react","CometRowItem.react","MWXText.react","react","stylex"],(function(a,b,c,d,e,f,g){"use strict";var h,i,j=i||(i=d("react"));b=i;var k=b.useEffect,l=b.useState,m={focusRing:{boxShadow:"x18bame2",outline:"xvetz19 x1a2a7pz",$$css:!0},input:{alignItems:"x6s0dn4",borderTopStartRadius:"xhk9q7s",borderTopEndRadius:"x1otrzb0",borderBottomEndRadius:"x1i1ezom",borderBottomStartRadius:"x1o6z2jb",borderTopStyle:"x1ejq31n",borderEndStyle:"xd10rxx",borderBottomStyle:"x1sy0etr",borderStartStyle:"x17r0tee",boxSizing:"x9f619",display:"x78zum5",height:"xng8ra",justifyContent:"xl56j7k",position:"x1n2onr6",width:"x1o817pb",$$css:!0},inputBox:{marginTop:"x1k70j0n",marginEnd:"x1w0mnb",marginBottom:"xzueoph",marginStart:"x1mnrxsn",$$css:!0},inputColorPrimary:{backgroundColor:"xljulmy",$$css:!0},inputColorSecondary:{backgroundColor:"xwcfey6",$$css:!0},inputSmall:{height:"xaymia4",width:"x1bgwkul",$$css:!0},inputTiny:{height:"x1vqgdyp",width:"x10faclu",$$css:!0}};function a(a){var b=a.color,d=b===void 0?"primary":b;b=a.disabled;var e=b===void 0?!1:b;b=a.enableMasking;var f=b===void 0?!1:b,g=a.hasFocus;b=a.inputSize;var i=b===void 0?"large":b,n=a.size;b=a.testid;b=b===void 0?"numeric-renderer":b;var o=a.value,p=function(a){return(o.length===a||o.length>a&&a===n-1)&&g};b=l(Array(n).fill(""));a=b[0];var q=b[1];k(function(){q(Array(n).fill().map(function(a,b){return o[b]!=null?f?"\u25cf":o[b]:""}))},[f,n,o]);return j.jsx(c("CometRow.react"),{align:"center",paddingHorizontal:0,paddingVertical:0,role:"group",spacing:0,children:a.map(function(a,b){return j.jsx(c("CometRowItem.react"),{xstyle:m.inputBox,children:j.jsx("div",{className:(h||(h=c("stylex")))(m.input,i==="small"&&m.inputSmall,i==="tiny"&&m.inputTiny,d==="primary"&&m.inputColorPrimary,d==="secondary"&&m.inputColorSecondary,p(b)&&m.focusRing),"data-testid":void 0,children:f?j.jsx(c("MWXText.react"),{color:e?"disabled":"primary",type:"headlineEmphasized4",children:e?"\u25cf":a}):j.jsx(c("MWXText.react"),{color:e?"disabled":"primary",type:"headlineEmphasized1",children:a})})},b)})})}a.displayName=a.name+" [from "+f.id+"]";g.MWChatEncryptedBackupsNumericCodeInputRenderer=a}),98);
__d("MWChatEncryptedBackupsNumericCodeInput.react",["MWChatEncryptedBackupsNumericCodeInputInner.react","MWChatEncryptedBackupsNumericCodeInputRenderer.react","react"],(function(a,b,c,d,e,f,g){"use strict";var h,i=h||(h=d("react")),j=h.useState;function a(a){var b=a.enableMasking,e=a.inputSize,f=a.size,g=a.testid;g=a.value;var h=j(!1),k=h[0];h=h[1];return i.jsxs("div",{className:"x1n2onr6",children:[i.jsx(d("MWChatEncryptedBackupsNumericCodeInputRenderer.react").MWChatEncryptedBackupsNumericCodeInputRenderer,{color:a.color,disabled:a.disabled,enableMasking:b,hasFocus:k,inputSize:e,size:f,testid:void 0,value:g}),i.jsx(c("MWChatEncryptedBackupsNumericCodeInputInner.react"),{extraProps:{setFocus:h},props:a})]})}a.displayName=a.name+" [from "+f.id+"]";g["default"]=a}),98);
__d("MWEBFlowSourceContextProvider.react",["MWEBFlowSourceContext","react"],(function(a,b,c,d,e,f,g){"use strict";var h,i=h||(h=d("react")),j=h.useMemo;function a(a){var b=a.children,d=a.source;a=j(function(){return{source:d}},[d]);return i.jsx(c("MWEBFlowSourceContext").Provider,{value:a,children:b})}a.displayName=a.name+" [from "+f.id+"]";g["default"]=a}),98);
__d("MWEBPinCodeSize",[],(function(a,b,c,d,e,f){"use strict";a=6;f.EB_PIN_CODE_SIZE=a}),66);
__d("MWEBQPWithPinState.enum",["$InternalEnum"],(function(a,b,c,d,e,f){"use strict";a=b("$InternalEnum")({INITIAL:0,RESTORE_IN_PROGRESS:1});c=a;f["default"]=c}),66);
__d("MWEBRestoreQPWithPin_viewer.graphql",[],(function(a,b,c,d,e,f){"use strict";a={argumentDefinitions:[],kind:"Fragment",metadata:null,name:"MWEBRestoreQPWithPin_viewer",selections:[{alias:null,args:null,concreteType:"MessengerDefaultEncryptedBackup",kind:"LinkedField",name:"messenger_default_encrypted_backup",plural:!1,selections:[{alias:null,args:null,concreteType:"VestaGetUserInfoResponse",kind:"LinkedField",name:"vesta_user_info",plural:!1,selections:[{args:null,kind:"FragmentSpread",name:"useMWChatEncryptedBackupsVestaUserInfo_vestaGetUserInfoResponse"}],storageKey:null}],storageKey:null},{alias:null,args:null,concreteType:"XFBEncryptedBackup",kind:"LinkedField",name:"encrypted_backup",plural:!1,selections:[{alias:null,args:null,kind:"ScalarField",name:"has_seen_eb_auto_restore_notice",storageKey:null}],storageKey:null},{kind:"ClientExtension",selections:[{alias:null,args:null,kind:"ScalarField",name:"qp_with_pin_state",storageKey:null}]}],type:"Viewer",abstractKey:null};e.exports=a}),null);
__d("MWEncryptedBackupsInsertOTCDialog.entrypoint",["JSResourceForInteraction"],(function(a,b,c,d,e,f,g){"use strict";a={getPreloadProps:function(){return{queries:{}}},root:c("JSResourceForInteraction")("MWEncryptedBackupsInsertOTCDialog.react").__setRef("MWEncryptedBackupsInsertOTCDialog.entrypoint")};g["default"]=a}),98);
__d("useMWChatEncryptedBackupsNumericCode",["FocusRegion.react","MWChatEncrypedBackupsNumericCodeValidation","asyncToGeneratorRuntime","focusScopeQueries","promiseDone","react"],(function(a,b,c,d,e,f,g){"use strict";var h;h||(h=d("react"));var i=h.useState;function a(a){var e=a.checkPreviouslyInsertedCode,f=a.clearInputOnComplete,g=f===void 0?!1:f;f=a.enableMasking;var h=a.focusRegionId,j=a.inputSize,k=a.onChange,l=a.onComplete;a=i(!1);var m=a[0],n=a[1];a=i(!0);var o=a[0],p=a[1];a=i("");var q=a[0],r=a[1];a=function(a){p(!a)};var s=function(){var a=b("asyncToGeneratorRuntime").asyncToGenerator(function*(a){if(d("MWChatEncrypedBackupsNumericCodeValidation").numericCodeIsCompleted(a,j)){if(e!=null){var b=e.onCodeMismatch,c=e.previouslyInsertedCode;c=c===a;if(!c){b();return}}p(!0);n(!0);try{yield l(a),g&&r("")}catch(a){r("")}finally{n(!1)}}});return function(b){return a.apply(this,arguments)}}();return[{disabled:m,enableMasking:f,focusRegionId:h,onChange:function(a){var b=function(){d("MWChatEncrypedBackupsNumericCodeValidation").numericCodeIsValid(a,j)&&(r(a),k==null?void 0:k(a),c("promiseDone")(s(a)))};b()},onCompletionChange:a,size:j,value:q},{clearNumericInput:function(){return r("")},disabled:o,focusOnInput:function(){d("FocusRegion.react").focusRegionById(h,d("focusScopeQueries").tabbableScopeQuery)},isLoading:m,onPress:function(){c("promiseDone")(s(q))}}]}g.useMWChatEncryptedBackupsNumericCode=a}),98);
__d("useMWChatEncryptedBackupsPinCodeRestore",["CometRelay","EBSMGating","JSResourceForInteraction","MWChatEncryptedBackupsLogging","MWChatEncryptedBackupsQPLEvents","MWChatEncryptedBackupsSetIsDialogPersistedContext","MWEBODSEntityName.enum","MWEBPinCodeSize","MWEBUpsellDismissedEnum.facebook","MWEncryptedBackupsLocalStorageEntryEnum","QPLUserFlow","asyncToGeneratorRuntime","promiseDone","react","requireDeferred","useLabyrinthLogging","useMWChatEncryptedBackupsAddDevice","useMWChatEncryptedBackupsNumericCode","useMWEBFlowSourceContext","useReStore"],(function(a,b,c,d,e,f,g){"use strict";var h,i;e=i||d("react");var j=e.useCallback,k=e.useContext,l=e.useEffect,m=e.useRef,n=e.useState,o=c("requireDeferred")("MWEBUseLocalStorage").__setRef("useMWChatEncryptedBackupsPinCodeRestore"),p=c("requireDeferred")("MWEncryptedBackupsSharedState").__setRef("useMWChatEncryptedBackupsPinCodeRestore"),q=c("requireDeferred")("mwEBGetPINSecretFromVesta").__setRef("useMWChatEncryptedBackupsPinCodeRestore"),r=c("requireDeferred")("updateUpsellsStateInRelayStore").__setRef("useMWChatEncryptedBackupsPinCodeRestore"),s=c("JSResourceForInteraction")("MWEncryptedBackupsHsmFleetMigrationGated").__setRef("useMWChatEncryptedBackupsPinCodeRestore");function a(a){var e=a.clientID,f=a.focusRegionId,g=a.onSubmitPin,i=a.onSubmitPinFailure,t=a.onVestaComplete,u=d("CometRelay").useRelayEnvironment();a=n(!1);var v=a[0],w=a[1];a=n(!1);var x=a[0],y=a[1];a=n(!1);var z=a[0],A=a[1],B=m(!1);a=d("useLabyrinthLogging").useLabyrinthLoggingFlow();var C=a.startFlow,D=(h||(h=c("useReStore")))(),E=c("useMWEBFlowSourceContext")();a=n(!1);var F=a[0],G=a[1],H=k(c("MWChatEncryptedBackupsSetIsDialogPersistedContext")).setIsDialogPersisted;a=c("useMWChatEncryptedBackupsAddDevice")({hsmFleetMigrationResetPIN:j(function(a){c("promiseDone")(s.load().then(function(b){b({db:D,environment:u,pinCode:a,startFlow:C})}))},[D,u,C]),onComplete:j(function(){var a;c("QPLUserFlow").addPoint((a=d("MWChatEncryptedBackupsQPLEvents")).restoreDeviceAuthQplEvent,"add_device_success");c("QPLUserFlow").addPoint(a.restoreQplEvent,"restore_auth_finished_and_dismissed");p.onReady(function(a){a=a.upsertEBSharedStateEntry;c("promiseDone")(a({db:D,stateKey:c("MWEncryptedBackupsLocalStorageEntryEnum").ENCRYPTED_BACKUPS_RESTORED_SUCCESSFULLY}))});o.onReady(function(a){var b=a.mwEBCreateLocalStorageEntry;a=a.mwEBDeleteLocalStorageEntry;b(c("MWEncryptedBackupsLocalStorageEntryEnum").MW_EB_HAS_RESTORED_IN_CURRENT_SESSION);b(c("MWEncryptedBackupsLocalStorageEntryEnum").MW_EB_HAS_RESTORED_IN_CURRENT_SESSION_2);a(c("MWEncryptedBackupsLocalStorageEntryEnum").EBSM_CORRUPTION_WIPE)});d("MWChatEncryptedBackupsLogging").endSuccess({annotations:{bool:{is_backend_setup:d("EBSMGating").isBackendSetupSuccessfulForEBSM()}},event:a.restoreQplEvent});d("MWChatEncryptedBackupsLogging").endSuccess({event:a.restoreDeviceAuthQplEvent,odsEntityName:c("MWEBODSEntityName.enum").MW_EB_PIN_RESTORE_AUTH});t();G(!1)},[D,t]),onFailure:j(function(a){i==null?void 0:i(),B.current=!0,y(!0),G(!1),c("QPLUserFlow").addPoint(d("MWChatEncryptedBackupsQPLEvents").restoreQplEvent,a),d("MWChatEncryptedBackupsLogging").endFailure({errorName:a,event:d("MWChatEncryptedBackupsQPLEvents").restoreDeviceAuthQplEvent,odsEntityName:c("MWEBODSEntityName.enum").MW_EB_PIN_RESTORE_AUTH}),c("promiseDone")(r.load(),function(a){a({environment:u,updateValue:d("MWEBUpsellDismissedEnum.facebook").MWEBUpsellDismissedStateEnum.NOT_DISMISSED})}),H==null?void 0:H(!1)},[u,i,H]),onInvalidRecoveryCode:j(function(){i==null?void 0:i(),B.current=!0,y(!0),G(!1),d("MWChatEncryptedBackupsLogging").endFailure({errorName:"pin_code_restore_wrong_recovery_code",event:d("MWChatEncryptedBackupsQPLEvents").restoreDeviceAuthQplEvent,odsEntityName:c("MWEBODSEntityName.enum").MW_EB_PIN_RESTORE_AUTH}),c("QPLUserFlow").addPoint(d("MWChatEncryptedBackupsQPLEvents").restoreQplEvent,"pin_code_restore_wrong_recovery_code"),c("promiseDone")(r.load(),function(a){a({environment:u,updateValue:d("MWEBUpsellDismissedEnum.facebook").MWEBUpsellDismissedStateEnum.NOT_DISMISSED})}),H==null?void 0:H(!1)},[u,i,H])});var I=a[0];a=d("useMWChatEncryptedBackupsNumericCode").useMWChatEncryptedBackupsNumericCode({enableMasking:!0,focusRegionId:f,inputSize:d("MWEBPinCodeSize").EB_PIN_CODE_SIZE,onChange:function(){y(!1),A(!1),w(!1)},onComplete:function(){var a=b("asyncToGeneratorRuntime").asyncToGenerator(function*(a){var b=(yield q.load());yield b({addDevice:I,clientID:e,environment:u,getSourceFromContext:E,onSubmitPin:g,onSubmitPinFailure:i,onVestaSecretFetch:function(){c("promiseDone")(r.load(),function(a){a({environment:u,updateValue:d("MWEBUpsellDismissedEnum.facebook").MWEBUpsellDismissedStateEnum.UPSELLS_DISMISSED})}),H==null?void 0:H(!0)},pinCode:a,productUseCase:"MSGR_ENC_BACKUP",setIsInProgress:G,setIsPinCodeIncorrect:w,setIsVestaError:A,startFlow:C})});function f(b){return a.apply(this,arguments)}return f}()});f=a[0];a=a[1];var J=a.clearNumericInput,K=a.disabled;a=a.focusOnInput;l(function(){B.current&&(J(),B.current=!1)},[J]);return{focusOnInput:a,inputProps:f,isDisabled:(a=K)!=null?a:!1,isInProgress:F,isLabyrinthError:x,isPinCodeIncorrect:v,isVestaError:z}}g.useMWChatEncryptedBackupsPinCodeRestore=a}),98);
__d("useMWChatEncryptedBackupsVestaUserInfo_vestaGetUserInfoResponse.graphql",[],(function(a,b,c,d,e,f){"use strict";a={argumentDefinitions:[],kind:"Fragment",metadata:null,name:"useMWChatEncryptedBackupsVestaUserInfo_vestaGetUserInfoResponse",selections:[{alias:null,args:null,kind:"ScalarField",name:"attempts_remaining",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"is_registered",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"login_timeout_remaining_secs",storageKey:null}],type:"VestaGetUserInfoResponse",abstractKey:null};e.exports=a}),null);
__d("useMWChatEncryptedBackupsVestaUserInfo",["CometRelay","useMWChatEncryptedBackupsVestaUserInfo_vestaGetUserInfoResponse.graphql"],(function(a,b,c,d,e,f,g){"use strict";var h;function a(a){var c;a=a.vestaGetUserInfoResponse$key;a=d("CometRelay").useFragment(h!==void 0?h:h=b("useMWChatEncryptedBackupsVestaUserInfo_vestaGetUserInfoResponse.graphql"),a);return{attemptsRemaining:(c=a==null?void 0:a.attempts_remaining)!=null?c:null,isRegistered:(c=a==null?void 0:a.is_registered)!=null?c:null,loginTimeoutRemainingSecs:(c=a==null?void 0:a.login_timeout_remaining_secs)!=null?c:null}}g["default"]=a}),98);
__d("MWEBRestoreQPWithPin.react",["fbt","CometRelay","EncryptedBackupsSupportedPlatformUtils","FBLogger","FocusRegion.react","JSResourceForInteraction","MWChatEBPinCodeVerifyIndicator.react","MWChatEncryptedBackupsForgotPINDialog.entrypoint","MWChatEncryptedBackupsLogging","MWChatEncryptedBackupsNumericCodeErrorWrapper.react","MWChatEncryptedBackupsNumericCodeInput.react","MWChatEncryptedBackupsQPLEvents","MWChatEncryptedBackupsQPLSource.enum","MWEBFlowSourceContextProvider.react","MWEBQPWithPinState.enum","MWEBRestoreQPWithPin_viewer.graphql","MWEncryptedBackupsInsertOTCDialog.entrypoint","MWEncryptedBackupsRetrieveQplLoggingAnnotations","MWJewelPopoverDialogContext.react","MWXCircleButton.react","MWXColumn.react","MWXColumnItem.react","MWXIconCross","MWXImage.react","MWXLink.react","MWXRow.react","MWXRowItem.react","MWXText.react","QPLUserFlow","cr:10043","cr:10045","focusScopeQueries","getMWEBRestoreQPCautionCircleProperties","gkx","promiseDone","react","stylex","useAsyncReStore","useLabyrinthLogging","useMWChatEncryptedBackupsPinCodeRestore","useMWChatEncryptedBackupsVestaUserInfo","useMWEBFlowSourceContext","useMWXEntryPointDialog","useMWXLazyDialog","useVisibilityObserver"],(function(a,b,c,d,e,f,g,h){"use strict";var i,j,k,l=k||(k=d("react"));e=k;var m=e.useCallback,n=e.useContext,o=e.useEffect,p=e.useRef,q=e.useState,r=c("JSResourceForInteraction")("MWChatEncryptedBackupsPinCodeBlockedDialog.react").__setRef("MWEBRestoreQPWithPin.react"),s="chat-encrypted-backups-jewel-qp-with-pin-input",t={card:{backgroundColor:"xlhe6ec",borderTopStartRadius:"x1lq5wgf",borderTopEndRadius:"xgqcy7u",borderBottomEndRadius:"x30kzoy",borderBottomStartRadius:"x9jhf4c",boxShadow:"xe4pinz",marginTop:"x14vqqas",marginEnd:"xktsk01",marginBottom:"xod5an3",marginStart:"x1d52u69",paddingTop:"xz9dl7a",paddingEnd:"xn6708d",paddingBottom:"xsag5q8",paddingStart:"x1ye3gou",$$css:!0},ctaWithError:{marginBottom:"x12nagc",paddingTop:"x1iorvi4",$$css:!0},ctaWithoutError:{marginBottom:"xod5an3",$$css:!0},icon:{paddingTop:"x889kno",$$css:!0},mdsCard:{backgroundColor:"x1jx94hy",$$css:!0}};function u(a){var e=a.clientID,f=a.currentSupportedPlatform,g=a.doesUserHaveOtcEligibleDevices,k=a.setClosed,u=a.setDismissed;a=a.viewer;var v=d("CometRelay").useFragment(i!==void 0?i:i=b("MWEBRestoreQPWithPin_viewer.graphql"),a),w=d("CometRelay").useRelayEnvironment(),x=m(function(a){return d("CometRelay").commitLocalUpdate(w,function(b){b=b.getRoot().getLinkedRecord("viewer");if(b==null){c("FBLogger")("labyrinth_web").mustfix("[labyrinth][jewel_softblock_state] A viewer record does not exist when propagating EB restore qp with pin state");return}b.setValue(a,"qp_with_pin_state")})},[w]);a=v==null?void 0:(a=v.messenger_default_encrypted_backup)==null?void 0:a.vesta_user_info;var y=c("useMWChatEncryptedBackupsVestaUserInfo")({vestaGetUserInfoResponse$key:a}),z=y.attemptsRemaining===0||y.loginTimeoutRemainingSecs!=null;a=q(!1);var A=a[0],B=a[1],C=p(!1);a=c("useMWXLazyDialog")(r);var D=a[0];o(function(){z&&A===!0&&C.current!==!0&&(C.current=!0,D({attemptsRemaining:y.attemptsRemaining,loginTimeoutRemainingSecs:y.loginTimeoutRemainingSecs,onDismiss:function(){}}))},[z,D,A,y.attemptsRemaining,y.loginTimeoutRemainingSecs]);a=d("useLabyrinthLogging").useLabyrinthLoggingFlow();var E=a.startFlow,F=c("useAsyncReStore")(),G=f!==d("EncryptedBackupsSupportedPlatformUtils").EncryptedBackupsSupportedPlatform.FACEBOOK_DOT_COM,H=G?c("MWChatEncryptedBackupsQPLSource.enum").INBOX_THREADLIST_QP_WITH_PIN:c("MWChatEncryptedBackupsQPLSource.enum").JEWEL_THREADLIST_QP_WITH_PIN,I=m(function(a){c("promiseDone")(F.then(function(b){d("MWEncryptedBackupsRetrieveQplLoggingAnnotations").encryptedBackupsRetrieveQplLoggingAnnotations({db:b,onFetch:function(b){var e=b.ebsmWiped,f=b.firstUpsellTime,h=b.hasEbKeysLocally,i=b.hasEBSM,j=b.hasPDB,k=b.hasUserRestoredBefore;b=b.hasUserRestoredBeforeTemp;E({additionalAnnotations:{eb_session_identifier:f,ebsm_wiped:e,has_eb_keys_locally:h,has_ebsm:i,has_pdb:j,has_user_restored_before:k,has_user_restored_before_temp:b,is_otc_eligible:g.toString(),is_pin_set:"true",restore_upsell_first_impression_time:f},event:d("MWChatEncryptedBackupsQPLEvents").restoreQplEvent,source:H});c("QPLUserFlow").addPoint(d("MWChatEncryptedBackupsQPLEvents").restoreQplEvent,a)}})}))},[F,E,g,H]);a=m(function(){var a=G?"RESTORE_QP_WITH_PIN_INBOX_DISMISSED":"RESTORE_QP_WITH_PIN_JEWEL_DISMISSED";I(a);d("MWChatEncryptedBackupsLogging").cancelFlow({cancelEndPoint:"thread_list_qp_with_pin",event:d("MWChatEncryptedBackupsQPLEvents").restoreQplEvent});k();u()},[G,k,u,I]);f=n(c("MWJewelPopoverDialogContext.react"));var J=f.setIsOpenForDialog,K=b("cr:10043")==null?void 0:b("cr:10043")(),L=b("cr:10045")==null?void 0:b("cr:10045")();f=m(function(){k();if(K!=null)K(H);else if(L!=null){var a;L({hasSeenNotice:(a=v==null?void 0:(a=v.encrypted_backup)==null?void 0:a.has_seen_eb_auto_restore_notice)!=null?a:!1,source:H})}J(!0);x(c("MWEBQPWithPinState.enum").INITIAL)},[k,K,L,x,H,J,v==null?void 0:(f=v.encrypted_backup)==null?void 0:f.has_seen_eb_auto_restore_notice]);e=d("useMWChatEncryptedBackupsPinCodeRestore").useMWChatEncryptedBackupsPinCodeRestore({clientID:e,focusRegionId:s,onSubmitPin:function(){B(!0),x(c("MWEBQPWithPinState.enum").RESTORE_IN_PROGRESS)},onSubmitPinFailure:function(){x(c("MWEBQPWithPinState.enum").INITIAL)},onVestaComplete:f});f=e.inputProps;var M=e.isInProgress,N=e.isLabyrinthError,O=e.isPinCodeIncorrect;e=e.isVestaError;M=(v==null?void 0:v.qp_with_pin_state)===c("MWEBQPWithPinState.enum").RESTORE_IN_PROGRESS||M;var P=c("useVisibilityObserver")({onVisible:function(){d("FocusRegion.react").focusRegionById(s,d("focusScopeQueries").tabbableScopeQuery);var a=G?"RESTORE_QP_WITH_PIN_INBOX_IMPRESSION":"RESTORE_QP_WITH_PIN_JEWEL_IMPRESSION";I(a)}}),Q=c("useMWXEntryPointDialog")(c("MWChatEncryptedBackupsForgotPINDialog.entrypoint"),{}),R=Q[0];Q=c("useMWXEntryPointDialog")(c("MWEncryptedBackupsInsertOTCDialog.entrypoint"),{});var S=Q[0],T=c("useMWEBFlowSourceContext")(),U=m(function(){var a=T();S({source:a},function(){c("QPLUserFlow").addPoint(d("MWChatEncryptedBackupsQPLEvents").restoreQplEvent,"OTC_RESTORE_CLOSE_DIALOG_CLICK")})},[T,S]),V=m(function(){R({onDismiss:function(){}})},[R]);Q=O?h._("__JHASH__TG8l6XqQAul__JHASH__"):N||e?h._("__JHASH__oI6Lha5PMTv__JHASH__"):void 0;if(z===!0){k();return null}O=c("gkx")("23219");return l.jsx("div",{className:(j||(j=c("stylex")))([t.card,O&&t.mdsCard]),children:l.jsxs(c("MWXColumn.react"),{ref:P,testid:void 0,children:[l.jsx(c("MWXColumnItem.react"),{children:l.jsxs(c("MWXRow.react"),{paddingHorizontal:0,paddingVertical:0,spacing:12,children:[l.jsx(c("MWXRowItem.react"),{xstyle:t.icon,children:l.jsx(c("MWXImage.react"),{src:c("getMWEBRestoreQPCautionCircleProperties")()})}),l.jsx(c("MWXRowItem.react"),{expanding:!0,children:l.jsxs(c("MWXColumn.react"),{paddingTop:8,spacing:12,children:[l.jsx(c("MWXColumnItem.react"),{children:l.jsx(c("MWXText.react"),{align:"start",numberOfLines:2,type:"headlineEmphasized4",children:h._("__JHASH__q7gZd-Mj8BZ__JHASH__")})}),l.jsx(c("MWXColumnItem.react"),{children:l.jsx(c("MWXText.react"),{align:"start",color:O?"secondary":"primary",numberOfLines:2,type:"body4",children:h._("__JHASH__vEuhoLIq_xI__JHASH__")})})]})}),l.jsx(c("MWXRowItem.react"),{children:l.jsx(c("MWXCircleButton.react"),{color:"primary",icon:c("MWXIconCross"),label:h._("__JHASH__4xGkXp7jS2s__JHASH__"),onPress:a,size:O?24:32,testid:void 0})})]})}),l.jsx(c("MWXColumnItem.react"),{paddingTop:16,children:l.jsx(c("MWChatEncryptedBackupsNumericCodeErrorWrapper.react"),{error:Q,inputSize:"small",children:l.jsx(d("FocusRegion.react").FocusRegion,{autoFocusQuery:d("focusScopeQueries").tabbableScopeQuery,id:s,children:l.jsx(c("MWChatEncryptedBackupsNumericCodeInput.react"),babelHelpers["extends"]({},f,{color:O?"primary":"secondary",disabled:M,inputSize:"small",testid:void 0}))})})}),M&&l.jsx(c("MWXColumnItem.react"),{align:"center",children:l.jsx("div",{className:"xfitlp5 x9otpla",children:l.jsx(c("MWChatEBPinCodeVerifyIndicator.react"),{isMessenger:O})})}),!M&&l.jsx(c("MWXColumnItem.react"),{align:"center",children:l.jsx("div",{className:(j||(j=c("stylex")))(Q==null&&t.ctaWithoutError,Q!=null&&t.ctaWithError),children:l.jsx(c("MWXText.react"),{type:"bodyLink4",children:g===!0?l.jsx(c("MWXLink.react"),{color_DEPRECATED:O?"primary":"blueLink",onClick:function(){c("QPLUserFlow").addPoint(d("MWChatEncryptedBackupsQPLEvents").restoreQplEvent,"OTC_RESTORE_USE_ONE_TIME_CODE_CLICK"),J(!0),U()},children:h._("__JHASH__FFwEA7rGUbF__JHASH__")}):l.jsx(c("MWXLink.react"),{color_DEPRECATED:O?"primary":"blueLink",onClick:function(){c("QPLUserFlow").addPoint(d("MWChatEncryptedBackupsQPLEvents").restoreQplEvent,"RESTORE_FORGOT_PIN_CLICK"),J(!0),V()},children:h._("__JHASH__UY_FDJp7Rzt__JHASH__")})})})})]})})}u.displayName=u.name+" [from "+f.id+"]";function a(a){var b=a.clientID,d=a.currentSupportedPlatform,e=a.doesUserHaveOtcEligibleDevices,f=a.setClosed,g=a.setDismissed;a=a.viewer;return l.jsx(c("MWEBFlowSourceContextProvider.react"),{source:c("MWChatEncryptedBackupsQPLSource.enum").JEWEL_THREADLIST_QP,children:l.jsx(u,{clientID:b,currentSupportedPlatform:d,doesUserHaveOtcEligibleDevices:e,setClosed:f,setDismissed:g,viewer:a})})}a.displayName=a.name+" [from "+f.id+"]";g["default"]=a}),226);
__d("useMWEBAutoRestoreConsentDialog",["JSResourceForInteraction","MWChatEncryptedBackupsQPLEvents","react","useLabyrinthLogging","useMWXLazyDialog"],(function(a,b,c,d,e,f,g){"use strict";var h,i=(h||d("react")).useCallback,j=c("JSResourceForInteraction")("MWEBAutoRestoreConsentDialog.react").__setRef("useMWEBAutoRestoreConsentDialog");function a(){var a=d("useLabyrinthLogging").useLabyrinthLoggingFlow(),b=a.startFlow;a=c("useMWXLazyDialog")(j);var e=a[0];return i(function(a){b({additionalAnnotations:{origin_surface:"qp_with_pin"},event:d("MWChatEncryptedBackupsQPLEvents").restoreWithAutoRestoreConsentQplEvent,source:a}),e({})},[e,b])}g["default"]=a}),98);